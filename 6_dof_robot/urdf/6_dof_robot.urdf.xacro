<?xml version="1.0"?>
<robot xmlns:xacro="http://wiki.ros.org/xacro" name="6_dof_robot">
  <!-- helper macro -->
  <xacro:include filename="$(find 6_dof_robot)/urdf/inc/create_link.xacro"/>

  <!-- create link fixed to the "world" -->
  <link name="world"/>

  <xacro:create_link
      link_name="base_link"
      xyz_offset="0 0 0"
      rpy_offset="0 0 0"
      mesh_package="6_dof_robot"
      mesh_name="link_0"
  />

  <xacro:create_link
      link_name="shoulder_link"
      xyz_offset="0 0 0"
      rpy_offset="0 0 0"
      mesh_package="6_dof_robot"
      mesh_name="link_1"
  />

  <xacro:create_link
      link_name="upper_arm_link"
      xyz_offset="0 0 0"
      rpy_offset="0 0 0"
      mesh_package="6_dof_robot"
      mesh_name="link_2"
  />

  <xacro:create_link
      link_name="forearm_link"
      xyz_offset="0 0 0"
      rpy_offset="0 0 0"
      mesh_package="6_dof_robot"
      mesh_name="link_3"
  />

  <xacro:create_link
      link_name="wrist_1_link"
      xyz_offset="0 0 0"
      rpy_offset="0 0 0"
      mesh_package="6_dof_robot"
      mesh_name="link_4"
  />

  <xacro:create_link
      link_name="wrist_2_link"
      xyz_offset="0 0 0"
      rpy_offset="0 0 0"
      mesh_package="6_dof_robot"
      mesh_name="link_5"
  />

  <xacro:create_link
      link_name="wrist_3_link"
      xyz_offset="0 0 0"
      rpy_offset="0 0 0"
      mesh_package="6_dof_robot"
      mesh_name="link_6"
  />

  <link name="ft_frame"/>

  <!-- base_joint fixes base_link to the environment -->
  <joint name="base_joint" type="fixed">
    <parent link="world"/>
    <child link="base_link"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
  </joint>

  <!-- joints - main serial chain -->
  <joint name="shoulder_pan_joint" type="revolute">
    <parent link="base_link"/>
    <child link="shoulder_link"/>
    <origin xyz="0 0 0.061584" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit effort="1000.0" lower="${-pi}" upper="${pi}" velocity="2.5" />
  </joint>
  <joint name="shoulder_lift_joint" type="revolute">
    <parent link="shoulder_link"/>
    <child link="upper_arm_link"/>
    <origin xyz="-0.101717 0 0.182284" rpy="${-pi/2} -${pi/3} ${pi/2}"/>
    <axis xyz="0 0 1"/>
    <limit effort="1000.0" lower="${-pi}" upper="${pi}" velocity="2.5" />
  </joint>
  <joint name="elbow_joint" type="revolute">
    <parent link="upper_arm_link"/>
    <child link="forearm_link"/>
    <origin xyz="0.685682 0 0.041861" rpy="0 ${pi} ${pi+pi/2}"/>
    <axis xyz="0 0 1"/>
    <limit effort="1000.0" lower="${-pi}" upper="${pi}" velocity="2.5" />
  </joint>
  <joint name="wrist_1_joint" type="revolute">
    <parent link="forearm_link"/>
    <child link="wrist_1_link"/>
    <origin xyz="0.518777 0 0.067458" rpy="0 ${pi} ${pi+pi/6}"/>
    <axis xyz="0 0 1"/>
    <limit effort="1000.0" lower="${-pi}" upper="${pi}" velocity="2.5" />
  </joint>
  <joint name="wrist_2_joint" type="revolute">
    <parent link="wrist_1_link"/>
    <child link="wrist_2_link"/>
    <origin xyz="0.112654 0 0.110903" rpy="${pi/2} ${pi} ${pi/2}"/>
    <axis xyz="0 0 1"/>
    <limit effort="1000.0" lower="${-pi}" upper="${pi}" velocity="2.5" />
  </joint>
  <joint name="wrist_3_joint" type="revolute">
    <parent link="wrist_2_link"/>
    <child link="wrist_3_link"/>
    <origin xyz="-0.085976 0 0.133436" rpy="0 ${-pi/2} 0"/>
    <axis xyz="0 0 1"/>
    <limit effort="1000.0" lower="${-pi}" upper="${pi}" velocity="2.5" />
  </joint>
  <joint name="wrist_3_link-ft_frame" type="fixed">
    <parent link="wrist_3_link"/>
    <child link="ft_frame"/>
    <origin xyz="0 0 0" rpy="${pi} 0 0"/>
    <limit effort="1000.0" lower="${-pi}" upper="${pi}" velocity="2.5" />
  </joint>

  <!-- ROS-Industrial 'base' frame - base_link to UR 'Base' Coordinates transform -->
  <link name="base"/>
  <joint name="base_link-base_fixed_joint" type="fixed">
    <origin xyz="0 0 0" rpy="0 0 ${pi}"/>
    <parent link="base_link"/>
    <child link="base"/>
  </joint>

  <!-- ROS-Industrial 'flange' frame - attachment point for EEF models -->
  <link name="flange"/>
  <joint name="wrist_3-flange" type="fixed">
    <parent link="wrist_3_link"/>
    <child link="flange"/>
    <origin xyz="0 0 0" rpy="0 ${-pi/2.0} ${-pi/2.0}"/>
  </joint>

  <!-- ROS-Industrial 'tool0' frame - all-zeros tool frame -->
  <link name="tool0"/>
  <joint name="flange-tool0" type="fixed">
    <!-- default toolframe - X+ left, Y+ up, Z+ front -->
    <origin xyz="0 0 0" rpy="${pi/2.0} 0 ${pi/2.0}"/>
    <parent link="flange"/>
    <child link="tool0"/>
  </joint>


  <!-- ros2 control tag -->
  <ros2_control name="6_dof_robot" type="system">

    <hardware>
      <plugin>fake_components/GenericSystem</plugin>
      <param name="fake_sensor_commands">true</param>
      <param name="state_following_offset">0.0</param>
    </hardware>

    <joint name="shoulder_pan_joint">
      <command_interface name="position">
        <param name="min">{-2*pi}</param>
        <param name="max">{2*pi}</param>
      </command_interface>
      <command_interface name="velocity">
        <param name="min">-3.15</param>
        <param name="max">3.15</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">0.0</param>
      </state_interface>
      <state_interface name="velocity"/>
      <state_interface name="effort"/>
    </joint>

    <joint name="shoulder_lift_joint">
      <command_interface name="position">
        <param name="min">{-2*pi}</param>
        <param name="max">{2*pi}</param>
      </command_interface>
      <command_interface name="velocity">
        <param name="min">-3.15</param>
        <param name="max">3.15</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">-1.57</param>
      </state_interface>
      <state_interface name="velocity"/>
      <state_interface name="effort"/>
    </joint>

    <joint name="elbow_joint">
      <command_interface name="position">
        <param name="min">{-pi}</param>
        <param name="max">{pi}</param>
      </command_interface>
      <command_interface name="velocity">
        <param name="min">-3.15</param>
        <param name="max">3.15</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">0.0</param>
      </state_interface>
      <state_interface name="velocity"/>
      <state_interface name="effort"/>
    </joint>

    <joint name="wrist_1_joint">
      <command_interface name="position">
        <param name="min">{-2*pi}</param>
        <param name="max">{2*pi}</param>
      </command_interface>
      <command_interface name="velocity">
        <param name="min">-3.2</param>
        <param name="max">3.2</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">-1.57</param>
      </state_interface>
      <state_interface name="velocity"/>
      <state_interface name="effort"/>
    </joint>

    <joint name="wrist_2_joint">
      <command_interface name="position">
        <param name="min">{-2*pi}</param>
        <param name="max">{2*pi}</param>
      </command_interface>
      <command_interface name="velocity">
        <param name="min">-3.2</param>
        <param name="max">3.2</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">0.0</param>
      </state_interface>
      <state_interface name="velocity"/>
      <state_interface name="effort"/>
    </joint>

    <joint name="wrist_3_joint">
      <command_interface name="position">
        <param name="min">{-2*pi}</param>
        <param name="max">{2*pi}</param>
      </command_interface>
      <command_interface name="velocity">
        <param name="min">-3.2</param>
        <param name="max">3.2</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">0.0</param>
      </state_interface>
      <state_interface name="velocity"/>
      <state_interface name="effort"/>
    </joint>

    <sensor name="tcp_fts_sensor">
      <state_interface name="force.x"/>
      <state_interface name="force.y"/>
      <state_interface name="force.z"/>
      <state_interface name="torque.x"/>
      <state_interface name="torque.y"/>
      <state_interface name="torque.z"/>
    </sensor>

  </ros2_control>

</robot>
